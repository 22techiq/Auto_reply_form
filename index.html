<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>McOwino||Contact Us</title>
<!-- Prevent iframe embedding -->
<meta http-equiv="X-Frame-Options" content="DENY">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#020617;
  --card:rgba(15,23,42,.75);
  --border:rgba(148,163,184,.2);
  --accent:#38bdf8;
  --text:#e5e7eb;
  --muted:#94a3b8;
  --success:#22c55e;
  --error:#ef4444;
}

*{box-sizing:border-box;margin:0;padding:0}

body{
  font-family:Poppins, sans-serif;
  background:#020617;
  color:var(--text);
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:20px;
}

.contact-card{
  max-width:520px;
  width:100%;
  background:var(--card);
  backdrop-filter:blur(12px);
  border:1px solid var(--border);
  border-radius:16px;
  padding:28px;
  box-shadow:0 20px 40px rgba(0,0,0,.4);
}

h2{text-align:center;margin-bottom:6px}
p{text-align:center;color:var(--muted);font-size:.9rem;margin-bottom:20px}

.form-group{margin-bottom:14px}
label{display:block;font-size:.85rem;color:var(--muted);margin-bottom:6px}

input,textarea{
  width:100%;
  padding:12px;
  background:#020617;
  border:1px solid var(--border);
  border-radius:10px;
  color:var(--text);
  font-family:inherit;
}

input:focus,textarea:focus{border-color:var(--accent);outline:none}
textarea{min-height:120px;resize:none}

button{
  width:100%;
  padding:12px;
  background:linear-gradient(135deg,#38bdf8,#0ea5e9);
  border:none;
  border-radius:10px;
  font-weight:600;
  cursor:pointer;
}

button:disabled{opacity:.6}

.status{text-align:center;margin-top:14px;font-size:.9rem}
.success{color:var(--success)}
.error{color:var(--error)}
</style>
</head>

<body>

<div class="contact-card">
  <h2>Contact Us</h2>
  <p>Send us a message and weâ€™ll respond shortly.</p>

  <form id="contactForm">
    <div class="form-group">
      <label>Full Name</label>
      <input type="text" name="name" required>
    </div>

    <div class="form-group">
      <label>Email Address</label>
      <input type="email" name="email" required>
    </div>

    <div class="form-group">
      <label>Subject</label>
      <input type="text" name="subject" required>
    </div>

    <div class="form-group">
      <label>Message</label>
      <textarea name="message" required></textarea>
    </div>

    <button type="submit" id="btn">Send Message</button>
  </form>

  <div id="status" class="status"></div>
</div>

<script>
const form = document.getElementById("contactForm");
const statusBox = document.getElementById("status");
const btn = document.getElementById("btn");

const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbytzr6McvFwoLNtMD__knFdhcOSFx7sClctF47TN8utl3vGA1_O_hiE1vdwoI3Kc47wyQ/exec";

form.addEventListener("submit", async e => {
  e.preventDefault();

  btn.disabled = true;
  btn.textContent = "Sending...";
  statusBox.textContent = "";

  const data = new URLSearchParams(new FormData(form));

  try {
    const res = await fetch(SCRIPT_URL, {
      method: "POST",
      body: data
    });

    const result = await res.json();

    if(result.status === "success"){
      statusBox.textContent = "Message sent successfully âœ”";
      statusBox.className = "status success";
      form.reset();
    } else {
      throw new Error();
    }
  } catch {
    statusBox.textContent = "Failed to send message. Try again.";
    statusBox.className = "status error";
  }

  btn.disabled = false;
  btn.textContent = "Send Message";
});
</script>


<script>
/* =================================
   1. Disable Right Click
================================= */
document.addEventListener("contextmenu", e => e.preventDefault());

/* =================================
   2. Disable Copy / Cut / Paste
================================= */
["copy", "cut", "paste", "dragstart"].forEach(evt => {
  document.addEventListener(evt, e => e.preventDefault());
});

/* =================================
   3. Block DevTools Shortcuts
================================= */
document.addEventListener("keydown", function (e) {
  if (
    e.key === "F12" ||
    (e.ctrlKey && e.shiftKey && ["I","J","C"].includes(e.key)) ||
    (e.ctrlKey && e.key === "U")
  ) {
    e.preventDefault();
    return false;
  }
});

/* =================================
   4. DevTools Size Detection
================================= */
setInterval(() => {
  const widthDiff  = window.outerWidth - window.innerWidth;
  const heightDiff = window.outerHeight - window.innerHeight;

  if (widthDiff > 160 || heightDiff > 160) {
    document.body.innerHTML =
      "<h2 style='color:red;margin-top:20%'>Access Denied</h2>";
  }
}, 1000);

/* =================================
   5. Console Open Detection
================================= */
(function () {
  const element = new Image();
  Object.defineProperty(element, "id", {
    get: function () {
      document.body.innerHTML =
        "<h2 style='color:red;margin-top:20%'>Inspection Blocked</h2>";
    }
  });
  console.log(element);
})();

/* =================================
   6. Anti-Debugger Trap
================================= */
setInterval(function () {
  debugger;
}, 2000);

/* =================================
   7. Hide Source via Visibility Change
================================= */
document.addEventListener("visibilitychange", function () {
  if (document.hidden) {
    document.body.style.display = "none";
  } else {
    document.body.style.display = "block";
  }
});

/* =================================
   8. Disable View Source via Mouse
================================= */
document.onmousedown = function (e) {
  if (e.button === 2) return false;
};
</script>


<!--Appscript
/*************************************************
 * CONTACT FORM BACKEND + AUTO-REPLY
 *************************************************/
function doPost(e) {
  try {
    const sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();

    const time = new Date();
    const name = e.parameter.name;
    const email = e.parameter.email;
    const subject = e.parameter.subject;
    const message = e.parameter.message;

    sheet.appendRow([time, name, email, subject, message]);

    // Admin notification
    MailApp.sendEmail({
      to: "22techiq@gmail.com", // CHANGE
      subject: "New Contact Message",
      htmlBody: `
        <h3>New Contact Submission</h3>
        <p><b>Name:</b> ${name}</p>
        <p><b>Email:</b> ${email}</p>
        <p><b>Subject:</b> ${subject}</p>
        <p><b>Message:</b><br>${message}</p>
      `
    });

    // Auto-reply
    MailApp.sendEmail({
      to: email,
      subject: "We received your message",
      htmlBody: `
        <p>Hello ${name},</p>
        <p>Thank you for contacting us. We have received your message and will respond shortly.</p>
        <p>Kind regards,<br><b>Support Team</b></p>
      `
    });

    return ContentService
      .createTextOutput(JSON.stringify({ status: "success" }))
      .setMimeType(ContentService.MimeType.JSON);

  } catch (err) {
    return ContentService
      .createTextOutput(JSON.stringify({ status: "error", message: err.message }))
      .setMimeType(ContentService.MimeType.JSON);
  }
}

/*************************************************
 * MANUAL MASS EMAIL FEATURE (ADMIN ONLY)
 *************************************************/

// Add menu when sheet opens
function onOpen() {
  SpreadsheetApp.getUi()
    .createMenu("ðŸ“§ Email Tools")
    .addItem("Send Mass Email", "massEmailPrompt")
    .addToUi();
}

// Prompt admin for subject & message
function massEmailPrompt() {
  const ui = SpreadsheetApp.getUi();

  const subject = ui.prompt(
    "Mass Email",
    "Enter email subject:",
    ui.ButtonSet.OK_CANCEL
  );
  if (subject.getSelectedButton() !== ui.Button.OK) return;

  const body = ui.prompt(
    "Mass Email",
    "Enter email message (HTML allowed):",
    ui.ButtonSet.OK_CANCEL
  );
  if (body.getSelectedButton() !== ui.Button.OK) return;

  sendMassEmail(subject.getResponseText(), body.getResponseText());
}

// Send email to all addresses in the sheet
function sendMassEmail(subject, body) {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  const data = sheet.getDataRange().getValues();

  let sent = 0;

  for (let i = 1; i < data.length; i++) {
    const email = data[i][2]; // Column C = Email

    if (email && email.includes("@")) {
      MailApp.sendEmail({
        to: email,
        subject: subject,
        htmlBody: body
      });
      sent++;
    }
  }

  SpreadsheetApp.getUi().alert(
    `Mass email successfully sent to ${sent} recipients.`
  );
}


-->
</body>
</html>